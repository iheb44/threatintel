name: "Critical IOC Detection"
type: any
index: iocs*
timestamp_field: timestamp
is_enabled: true

run_every:
  minutes: 2

buffer_time:
  minutes: 5

# Alert on ALL IOCs initially (for testing)
filter:
- query:
    match_all: {}

include:
  - ioc_value
  - ioc_type
  - source_feed
  - timestamp

alert:
  - "debug"

alert_subject: "IOC Detected: {0}"
alert_subject_args:
  - ioc_value

alert_text: |
  IOC detected in threat intelligence feed!
  - Value: {0}
  - Type: {1} 
  - Source: {2}
  - Time: {3}

alert_text_args:
  - ioc_value
  - ioc_type
  - source_feed
  - timestamp

realert:
  minutes: 5
